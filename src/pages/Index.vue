<template>
  <Layout>
    <div class="bg-gray-200">
      <div class="max-w-screen-md m-auto text-xs text-gray-700 py-1">
        Un service de l'Incubateur des Territoires de l'Agence Nationale de la Cohesion des Territoires
      </div>
    </div>
    
    <header class="max-w-screen-md m-auto mt-8">
      <h1 class="text-5xl font-bold text-gray-900">üìñ Territoires Store</h1>
      <h2 class="text-gray-800">Le catalogue des services publics num√©riques</h2>
    </header>

    <div v-if="step === 'selection'">
      <div class="max-w-screen-md m-auto mt-8 text-gray-800">
        Vous pouvez s√©lectionner les services qui vous int√©ressent, √™tre recontact√© et recevoir des informations compl√©mentaires pour les d√©ployer sur votre territoire.
      </div>

      <div class="max-w-screen-md m-auto mt-8 text-gray-800">
        <ServicesParThematique 
          thematique="Mobilit√©"
          :services="$page.mobilite"
          v-model="selectedServices"
        />
        <ServicesParThematique 
          thematique="D√©chets"
          :services="$page.dechets"
          v-model="selectedServices"
        />
        <ServicesParThematique 
          thematique="Logement"
          :services="$page.logement"
          v-model="selectedServices"
        />
        <ServicesParThematique 
          thematique="D√©marches administratives"
          :services="$page.demarchesAdministratives" 
          v-model="selectedServices"
        />
        <ServicesParThematique 
          thematique="Aides pour collectivit√©s"
          :services="$page.aidePourCollectivites"
          v-model="selectedServices"
        />
        <ServicesParThematique 
          thematique="Accessibilit√©"
          :services="$page.accessibilite"
          v-model="selectedServices"
        />
        <ServicesParThematique 
          thematique="Emploi et Entreprise"
          :services="$page.emploiEtEntreprise"
          v-model="selectedServices"
        />
        <ServicesParThematique 
          thematique="Donn√©es"
          :services="$page.donnees"
          v-model="selectedServices"
        />
        <ServicesParThematique 
          thematique="Urbanisme"
          :services="$page.urbanisme"
          v-model="selectedServices"
        />
        <ServicesParThematique 
          thematique="Solidarit√©"
          :services="$page.solidarite"
          v-model="selectedServices"
        />
        <ServicesParThematique 
          thematique="Agriculture"
          :services="$page.agriculture"
          v-model="selectedServices"
        />

        <div>
          Vous avez besoin d'un autre service public num√©rique ?
          Nous pouvons le construire ensemble !
        </div>
      </div>

      <div class="max-w-screen-md m-auto mt-8 text-gray-800">
        <button 
          class="inline-block py-2 px-4 bg-blue-500 text-white font-semibold rounded-md cursor-pointer hover:bg-blue-800"
          v-on:click="step = 'form'"
        >
          √ätre recontact√© ‚ûî
        </button>
      </div>
    </div>

    <ConfirmationForm
      class="max-w-screen-md m-auto mt-8 text-gray-800"
      v-if="step === 'form'"
      :selectedServices="selectedServices"
    />

    <footer class="bg-gray-200 mt-12" style="height:100px">
    </footer>
  </Layout>
</template>

<script>
import ServicesParThematique from '~/components/ServicesParThematique';
import ConfirmationForm from '~/components/ConfirmationForm.vue'

export default {
  metaInfo: {
    title: 'üìñ Territoires Store'
  },
  components: {
    ServicesParThematique,
    ConfirmationForm
  },
  data() {
    return {
      step: "selection",
      selectedServices: []
    }
  }
}
</script>

<page-query>
query {
	mobilite: allService(filter: { thematique: { contains: ["Mobilit√©"] }}) {
    edges {
      node {
        service
        action
        url
        contact
        thematique
        fileInfo {
          name
        }
      }
    }
  }

	dechets: allService(filter: { thematique: { contains: ["D√©chets"] }}) {
    edges {
      node {
        service
        action
        url
        contact
        thematique
        fileInfo {
          name
        }
      }
    }
  }

  logement: allService(filter: { thematique: { contains: ["Logement"] }}) {
    edges {
      node {
        service
        action
        url
        contact
        thematique
        fileInfo {
          name
        }
      }
    }
  }

  demarchesAdministratives: allService(filter: { thematique: { contains: ["D√©marches administratives"] }}) {
    edges {
      node {
        service
        action
        url
        contact
        thematique
        fileInfo {
          name
        }
      }
    }
  }

  aidePourCollectivites: allService(filter: { thematique: { contains: ["Aides pour collectivit√©s"] }}) {
    edges {
      node {
        service
        action
        url
        contact
        thematique
        fileInfo {
          name
        }
      }
    }
  }

  accessibilite: allService(filter: { thematique: { contains: ["Accessibilit√©"] }}) {
    edges {
      node {
        service
        action
        url
        contact
        thematique
        fileInfo {
          name
        }
      }
    }
  }

  emploiEtEntreprise: allService(filter: { thematique: { contains: ["Emploi et Entreprise"] }}) {
    edges {
      node {
        service
        action
        url
        contact
        thematique
        fileInfo {
          name
        }
      }
    }
  }

  donnees: allService(filter: { thematique: { contains: ["Donn√©es"] }}) {
    edges {
      node {
        service
        action
        url
        contact
        thematique
        fileInfo {
          name
        }
      }
    }
  }

  urbanisme: allService(filter: { thematique: { contains: ["Urbanisme"] }}) {
    edges {
      node {
        service
        action
        url
        contact
        thematique
        fileInfo {
          name
        }
      }
    }
  }

  solidarite: allService(filter: { thematique: { contains: ["Solidarit√©"] }}) {
    edges {
      node {
        service
        action
        url
        contact
        thematique
        fileInfo {
          name
        }
      }
    }
  }

	agriculture: allService(filter: { thematique: { contains: ["Agriculture"] }}) {
    edges {
      node {
        service
        action
        url
        contact
        thematique
        fileInfo {
          name
        }
      }
    }
  }
}
</page-query>
